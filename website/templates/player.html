<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../static/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <title>{{ player.Name if player else "Player Detail" }}</title>
</head>
<body>
    <!--Navigation-->
    <nav class="navbar">
      <div class="nav-container">
        <div class="logo">
          <img src="../static/images/Logo.png" alt="Logo" />
          <span>Fajar Febriansyah Group</span>
        </div>
        <ul class="nav-menu">
          <li><a href="/" class="nav-link">Home</a></li>
          <li><a href="/players" class="nav-link active">Performance Player</a></li>
          <li><a href="/compare" class="nav-link">Compare Player</a></li>
        </ul>
      </div>
    </nav>
    <!--End Navigation-->

    <!-- Performance Player Detail Section -->
    {% if player %}

    {# === helper buat memberi class warna berdasarkan nilai === #}
    {% macro color_class(val) -%}
        {%- if val is not none and val|string != "" -%}
        {%- set v = val|int -%}
        {%- if v >= 90 -%} val-blue
        {%- elif v >= 80 -%} val-green
        {%- elif v >= 70 -%} val-yellow
        {%- else -%} val-red
        {%- endif -%}
        {%- else -%} val-gray
        {%- endif -%}
    {%- endmacro %}
    <main class="main-content">
      <section id="playerDetailView" class="player-detail">
        <h2 class="section-title">{{ player.Name }}</h2>
        <a href="/players" class="back-btn">
            Back to Players
        </a>
        <div class="perf-grid">
          <!-- Left: Player Info -->
          <div class="card info-card">
            <h3 class="card-title">PLAYER INFO</h3>              
            <div class="info-top">
              <img id="perfPhoto" class="info-photo" 
                   src="{{ player.Photo or '../static/images/default.png' }}" 
                   alt="{{ player.Name }}" />
              <ul class="info-list">
                <li><span>Name</span>: <strong>{{ player.Name or "–" }}</strong></li>
                <li><span>Club</span>: <span>{{ player.Team or "–" }}</span></li>
                <li><span>Position</span>: <span>{{ player.Position or "–" }}</span></li>
                <li><span>Age</span>: <span>{{ player.Age or "–" }}</span></li>
                <li><span>Season</span>: <span>{{ player.Season or "–" }}</span></li>
                <li><span>Height</span>: <span>{{ player.Height or "–" }}</span></li>
                <li><span>Weight</span>: <span>{{ player.Weight or "–" }}</span></li>
              </ul>
            </div>
            <div class="radar-wrap">
              <canvas id="perfRadar"></canvas>
            </div>
          </div>

          <!-- Right: Attribute Table -->
          <div class="card attr-card">
            <h3 class="card-title center">ATTRIBUTE</h3>
            <div class="attr-table">
                <!--Physical-->
              <div class="attr-col">
                <h4>Physical</h4>
                    <ul>
                        <li>Acceleration: <span class="value">{{ player.Acceleration or "–" }}</span></li>
                        <li>Agility: <span class="value">{{ player.Agility or "–" }}</span></li>
                        <li>Balance: <span class="value">{{ player.Balance or "–" }}</span></li>
                        <li>Jumping Reach: <span class="value">{{ player.JumpingReach or "–" }}</span></li>
                        <li>Natural Fitness: <span class="value">{{ player.NaturalFitness or "–" }}</span></li>
                        <li>Pace: <span class="value">{{ player.Pace or "–" }}</span></li>
                        <li>Stamina: <span class="value">{{ player.Stamina or "–" }}</span></li>
                        <li>Strength: <span class="value">{{ player.Strength or "–" }}</span></li>
                        <li>Goalkeeper Ability: <span class="value">{{ player.GoalkeeperAbility or "–" }}</span></li>
                        <li>Condition: <span class="value">{{ player.Condition or "–" }}</span></li>
                        <li>Preferred Foot: <span class="value">{{ player.PreferredFoot or "–" }}</span></li>
                    </ul>
                </div>
                <!--Technical-->
              <div class="attr-col">
                <h4>Technical</h4>
                <ul>
                    <li>Dribbling: <span class="value">{{ player.Dribbling or "–" }}</span></li>
                    <li>Passing: <span class="value">{{ player.Passing or "–" }}</span></li>
                    <li>Corners: <span class="value">{{ player.Corners or "–" }}</span></li>
                    <li>Crossing: <span class="value">{{ player.Crossing or "–" }}</span></li>
                    <li>First Touch: <span class="value">{{ player.FirstTouch or "–" }}</span></li>
                    <li>Finishing: <span class="value">{{ player.Finishing or "–" }}</span></li>
                    <li>Penalty: <span class="value">{{ player.Penalty or "–" }}</span></li>
                    <li>Free Kick: <span class="value">{{ player.FreeKick or "–" }}</span></li>
                    <li>Long Shots: <span class="value">{{ player.LongShots or "–" }}</span></li>
                    <li>Long Throws: <span class="value">{{ player.LongThrows or "–" }}</span></li>
                    <li>Heading: <span class="value">{{ player.Heading or "–" }}</span></li>
                    <li>Marking: <span class="value">{{ player.Marking or "–" }}</span></li>
                    <li>Tackling: <span class="value">{{ player.Tackling or "–" }}</span></li>
                    <li>Technique: <span class="value">{{ player.Technique or "–" }}</span></li>
                </ul>
              </div>
              <!--Mental-->
              <div class="attr-col">
                <h4>Mental</h4>
                <ul>
                    <li>Aggression: <span class="value">{{ player.Aggression or "–" }}</span></li>
                    <li>Anticipation: <span class="value">{{ player.Anticipation or "–" }}</span></li>
                    <li>Bravery: <span class="value">{{ player.Bravery or "–" }}</span></li>
                    <li>Composure: <span class="value">{{ player.Composure or "–" }}</span></li>
                    <li>Concentration: <span class="value">{{ player.Concentration or "–" }}</span></li>
                    <li>Decisions: <span class="value">{{ player.Decisions or "–" }}</span></li>
                    <li>Determination: <span class="value">{{ player.Determination or "–" }}</span></li>
                    <li>Flair: <span class="value">{{ player.Flair or "–" }}</span></li>
                    <li>Leadership: <span class="value">{{ player.Leadership or "–" }}</span></li>
                    <li>Off the ball: <span class="value">{{ player.OffTheBall or "–" }}</span></li>
                    <li>Positioning: <span class="value">{{ player.Positioning or "–" }}</span></li>
                    <li>Teamwork: <span class="value">{{ player.Teamwork or "–" }}</span></li>
                    <li>Vision: <span class="value">{{ player.Vision or "–" }}</span></li>
                    <li>Work Rate: <span class="value">{{ player.WorkRate or "–" }}</span></li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Bottom: Match Statistic -->
          <div class="card stats-card">
            <h3 class="card-title center">MATCH STATISTIC</h3>
            <div class="table-wrap">
              <table class="stat-table">
                <thead>
                  <tr>
                    <th>Match</th>
                    <th>Goals</th>
                    <th>Assists</th>
                    <th>Shot (on target)</th>
                    <th>Passes (Compl)</th>
                    <th>Saves</th>
                    <th>Fouls</th>
                    <th>Cards</th>
                    <th>Tackles</th>
                    <th>Match Rating</th>
                  </tr>
                </thead>
                <tbody>
                  {% if player.MatchStats %}
                    {% for match in player.MatchStats %}
                    <tr>
                      <td>{{ match.name or "–" }}</td>
                      <td>{{ match.goals or "–" }}</td>
                      <td>{{ match.assists or "–" }}</td>
                      <td>{{ match.shots or "–" }}</td>
                      <td>{{ match.passes or "–" }}</td>
                      <td>{{ match.saves or "–" }}</td>
                      <td>{{ match.fouls or "–" }}</td>
                      <td>{{ match.cards or "–" }}</td>
                      <td>{{ match.tackles or "–" }}</td>
                      <td>{{ match.rating or "–" }}</td>
                    </tr>
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="10">No stats available</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>
    {% else %}
    <p style="text-align:center;margin-top:100px;">No player data available.</p>
    {% endif %}
          <script id="playersData" type="application/json">
            {{ player|tojson }}
          </script> 
          <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    </body>
</html>